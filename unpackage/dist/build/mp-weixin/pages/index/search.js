"use strict";const e=require("../../common/vendor.js"),a=require("../../apis/search.js"),l=require("../../apis/clan.js");require("../../store/index.js");const o=require("../../store/modules/userInf.js");if(!Array){(e.resolveComponent("uni-pagination")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../uni_modules/uni-pagination/components/uni-pagination/uni-pagination.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const n={__name:"search",setup(n){const u=o.useUserStore(),t=e.ref({name:"",place:"",id:0}),c=e.ref(null),i=e.ref({areaValue:"",clanValue:""});e.ref(0);const s=e.ref(0),r=e.ref(0),p=e.ref(null),d=()=>{console.log("pagechange"),a.getclanbyplace({page:s.value,size:4,name:i.value.clanValue,place:i.value.areaValue}).then((e=>{console.log(e.data),p.value=e.data.list,r.value=e.data.total})),e.index.pageScrollTo({scrollTop:0,duration:300})};return(o,n)=>e.e({a:i.value.areaValue,b:e.o((e=>i.value.areaValue=e.detail.value)),c:i.value.clanValue,d:e.o((e=>i.value.clanValue=e.detail.value)),e:e.o((l=>(r.value=0,s.value=1,p.value=null,console.log(i.value),void a.getclanbyplace({page:s.value,size:4,name:i.value.clanValue,place:i.value.areaValue}).then((a=>{a.data?(console.log(a.data),p.value=a.data.list,console.log(p.value),r.value=a.data.total):e.index.showToast({icon:"none",duration:22e3,title:"族谱不存在"})}))))),f:p.value},p.value?{g:e.f(p.value,((a,l,o)=>({a:a.url,b:e.t(a.name),c:e.t(a.place),d:e.t(a.describe),e:a.id,f:e.o((e=>(e=>{t.value=e,console.log(t.value),c.value.open()})(a)),a.id)}))),h:e.o(d),i:e.o((e=>s.value=e)),j:e.p({title:"标题文字",total:r.value,"show-icon":!0,"page-size":4,modelValue:s.value})}:{},{k:e.t(t.value.name),l:e.t(t.value.place),m:e.o((e=>{c.value.close()})),n:e.o((a=>{return o=t.value.id,console.log(o,u.accountInf.account),void l.bindFamily({account:u.accountInf.account,treeId:o}).then((a=>{console.log(a.msg),"ok"===a.msg&&(u.accountInf.treeId=o,u.accountInf.treeIdChange=!0,c.value.close(),setTimeout((()=>{e.index.switchTab({url:"../clan/clan"})}),500),e.index.showToast({icon:"none",duration:1e3,title:"绑定成功"}))}));var o})),o:e.sr(c,"9bd29df3-1",{k:"popup"}),p:e.p({type:"center","border-radius":"10px 10px 0 0"})})}},u=e._export_sfc(n,[["__scopeId","data-v-9bd29df3"]]);wx.createPage(u);
